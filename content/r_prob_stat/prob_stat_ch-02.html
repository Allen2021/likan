---
title: "第2章、数据探索"
author: "侃侃迩行"
date: '2017-02-15'
output:
  blogdown::html_page:
    toc: true
---


<div id="TOC">
<ul>
<li><a>2.1. 什么是统计学</a></li>
<li><a>2.2. 数据</a></li>
<li><a>2.3. 定性数据</a><ul>
<li><a>2.3.1. 频率分析表</a></li>
<li><a>2.3.2. 盒状图</a></li>
<li><a>2.3.3. 点状图</a></li>
<li><a>2.3.3. 饼状图</a></li>
</ul></li>
<li><a>2.4. 定量数据</a><ul>
<li><a href="#stem-leaf">2.4.1 茎叶图</a></li>
<li><a href="#strip-charts">2.4.2 Strip Charts</a></li>
<li><a href="#Density-Curves">2.4.3 密度曲线</a><ul>
<li><a href="#Histograms">2.4.3.1 直方图</a></li>
</ul></li>
</ul></li>
</ul>
</div>
<div class="section level1">
<h1>2.1. 什么是统计学</h1>
</div>
<div class="section level1">
<h1>2.2. 数据</h1>
</div>
<div class="section level1">
<h1>2.3. 定性数据</h1>
<div class="section level2">
<h2>2.3.1. 频率分析表</h2>
<ul>
<li>vector</li>
</ul>
<pre class="r"><code>Grades &lt;- c(&quot;A&quot;, &quot;D&quot;, &quot;C&quot;, &quot;D&quot;, &quot;C&quot;, &quot;C&quot;, &quot;C&quot;, &quot;C&quot;, &quot;F&quot;, &quot;B&quot;)
Grades
table(Grades)
xtabs(~ Grades)
table(Grades) / length(Grades) # Relative frequency table
prop.table(table(Grades))</code></pre>
<pre><code>##  [1] &quot;A&quot; &quot;D&quot; &quot;C&quot; &quot;D&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;C&quot; &quot;F&quot; &quot;B&quot;
## Grades
## A B C D F 
## 1 1 5 2 1 
## Grades
## A B C D F 
## 1 1 5 2 1 
## Grades
##   A   B   C   D   F 
## 0.1 0.1 0.5 0.2 0.1 
## Grades
##   A   B   C   D   F 
## 0.1 0.1 0.5 0.2 0.1</code></pre>
<ul>
<li>data frame</li>
</ul>
<pre class="r"><code>library(MASS)
table(quine$Age)
with(data = quine, table(Age))
xtabs(~ Age, data = quine)</code></pre>
<pre><code>## 
## F0 F1 F2 F3 
## 27 46 40 33 
## Age
## F0 F1 F2 F3 
## 27 46 40 33 
## Age
## F0 F1 F2 F3 
## 27 46 40 33</code></pre>
</div>
<div class="section level2">
<h2>2.3.2. 盒状图</h2>
<pre class="r"><code>opar &lt;- par(no.readonly = TRUE) # read in current parameters
par(mfrow=c(2, 2)) # change parameters
barplot(xtabs( ~ Grades),
        col = &quot;gray40&quot;,
        xlab = &quot;Grades&quot;,
        ylab = &quot;Frequency&quot;
)
barplot(prop.table(xtabs(~ Grades)),
        col = &quot;gray40&quot;,
        xlab = &quot;Grades&quot;,
        ylab = &quot;Relative Frequency&quot;
)
barplot(xtabs(~ Age, data = quine),
        col = &quot;gray90&quot;,
        xlab = &quot;Age&quot;,
        ylab = &quot;Frequency&quot;
)
barplot(prop.table(xtabs(~ Age, data = quine)),
        col = &quot;gray90&quot;,
        xlab = &quot;Age&quot;,
        ylab = &quot;Relative Frequency&quot;
)</code></pre>
<p><img src="/r_prob_stat/prob_stat_ch-02_files/figure-html/Figure_02_01-1.png" width="672" /></p>
<pre class="r"><code>par(opar) # reset to original parameters</code></pre>
</div>
<div class="section level2">
<h2>2.3.3. 点状图</h2>
<ul>
<li>图2.2</li>
</ul>
<pre class="r"><code>oldw &lt;- getOption(&quot;warn&quot;)
options(warn = -1)
opar &lt;- par(no.readonly = TRUE) # read in current parameters
par(mfrow = c(1, 2))
dotchart(xtabs( ~ Grades),
         main = &quot;Grades&quot;,
         bg = &quot;gray40&quot;,
         xlim = c(0, 6)
)
dotchart(xtabs(~ Age, data = quine),
        main = &quot;Age&quot;,
        bg = &quot;gray60&quot;,
        xlim = c(25, 50)
)</code></pre>
<p><img src="/r_prob_stat/prob_stat_ch-02_files/figure-html/Figure_02_02-1.png" width="672" /></p>
<pre class="r"><code>par(opar) # reset to original parameters
options(warn = oldw)</code></pre>
<ul>
<li>图2.3</li>
</ul>
<pre class="r"><code>oldw &lt;- getOption(&quot;warn&quot;)
options(warn = -1)
opar &lt;- par(no.readonly = TRUE) # read in current parameters
par(mfrow = c(1, 2))
TDM &lt;- xtabs(Days ~ Age, data = quine)
dotchart(TDM,
         bg = &quot;gray40&quot;,
         xlab = &quot;Total Days Missed&quot;,
         xlim = c(400, 600)
)
ADM &lt;- with (
       data = quine,
       tapply(Days, list(Age), mean)
)
dotchart(ADM,
       xlab = &quot;Avage Days Missed&quot;,
       bg = &quot;gray60&quot;,
       xlim = c(10, 22)
)</code></pre>
<p><img src="/r_prob_stat/prob_stat_ch-02_files/figure-html/Figure_02_03-1.png" width="672" /></p>
<pre class="r"><code>par(opar) # reset to original parameters
options(warn = oldw)</code></pre>
</div>
<div class="section level2">
<h2>2.3.3. 饼状图</h2>
<pre class="r"><code>opar &lt;- par(no.readonly = TRUE) # read in current parameters
par(mfrow = c(1, 2))
GS &lt;- gray(c(0.1, 0.4, 0.7, 0.8, 0.95)) # different grays
pie(xtabs( ~ Grades, data = quine),
    radius = 1,
    col = GS
)
mtext(
    &quot;Grades&quot;,
    side = 3,
    cex = 1.25,
    line = 1
)
pie(xtabs( ~ Age, data = quine),
    radius = 1,
    col = GS
)
mtext(
    &quot;Age&quot;,
    side = 3,
    cex = 1.25,
    line = 1
)</code></pre>
<p><img src="/r_prob_stat/prob_stat_ch-02_files/figure-html/Figure_02_04-1.png" width="672" /></p>
<pre class="r"><code>par(opar) # reset to original parameters</code></pre>
</div>
</div>
<div class="section level1">
<h1>2.4. 定量数据</h1>
<div id="stem-leaf" class="section level2">
<h2>2.4.1 茎叶图</h2>
<ul>
<li>茎叶图适合展示小样本数据 (小于 100 个数据)。</li>
</ul>
<pre class="r"><code>NYYHR &lt;- BABERUTH$hr[BABERUTH$team == &quot;NY-A&quot;]
stem(NYYHR)</code></pre>
<pre><code>## 
##   The decimal point is 1 digit(s) to the right of the |
## 
##   2 | 25
##   3 | 45
##   4 | 1166679
##   5 | 449
##   6 | 0</code></pre>
<pre class="r"><code>rm(NYYHR)</code></pre>
</div>
<div id="strip-charts" class="section level2">
<h2>2.4.2 Strip Charts</h2>
<ul>
<li><code>stripchart()</code> 函数</li>
</ul>
<pre class="r"><code>args(stripchart)</code></pre>
<pre><code>## function (x, ...) 
## NULL</code></pre>
<ul>
<li>数据 <code>BABERUTH</code></li>
</ul>
<pre class="r"><code>head(BABERUTH)</code></pre>
<pre><code>##   year  team   g  ab   r   h X2b X3b hr rbi sb  bb    ba   slg
## 1 1914 Bos-A   5  10   1   2   1   0  0   0  0   0 0.200 0.300
## 2 1915 Bos-A  42  92  16  29  10   1  4  21  0   9 0.315 0.576
## 3 1916 Bos-A  67 136  18  37   5   3  3  16  0  10 0.272 0.419
## 4 1917 Bos-A  52 123  14  40   6   3  2  12  0  12 0.325 0.472
## 5 1918 Bos-A  95 317  50  95  26  11 11  66  6  58 0.300 0.555
## 6 1919 Bos-A 130 432 103 139  34  12 29 114  7 101 0.322 0.657</code></pre>
<pre class="r"><code>NYYHR &lt;- with(data = BABERUTH, hr[7 : 21])</code></pre>
<ul>
<li>图 2.6</li>
</ul>
<pre class="r"><code>stripchart(
  NYYHR,
  xlab = &quot;Home runs per season&quot;,
  method = &quot;stack&quot;,
  main = &quot;Strip chart of home runs while a New York Yankee&quot;,
  pch = 1
  )</code></pre>
<p><img src="/r_prob_stat/prob_stat_ch-02_files/figure-html/Figure_02_06-1.png" width="672" /></p>
<pre class="r"><code>rm (NYYHR)</code></pre>
<ul>
<li>图 2.7</li>
</ul>
<pre class="r"><code>opar &lt;- par(no.readonly = TRUE) # 读取现在的参数
par(mfrow = c(1, 2))
stripchart(
  hr ~ team,
  data = BABERUTH,
  xlab = &quot;Home runs per season&quot;,
  method = &quot;stack&quot;,
  pch = 1
  )
title (&quot;Strip chart of home \n runs by team&quot;)
par(las = 1)  # 纵坐标标签改为水平方向
stripchart(
  hr ~ team,
  data = BABERUTH,
  pch = 19,
  method = &quot;stack&quot;,
  col = c(&quot;gray30&quot;, &quot;gray50&quot;, &quot;gray70&quot;),
  xlab = &quot;Home runs per season&quot;,
  main = &quot;Grayscale chart of \n home runs by team&quot;
  )</code></pre>
<p><img src="/r_prob_stat/prob_stat_ch-02_files/figure-html/Figure_02_07-1.png" width="672" /></p>
<pre class="r"><code>par(opar) # 还原原始参数设置</code></pre>
</div>
<div id="Density-Curves" class="section level2">
<h2>2.4.3 密度曲线</h2>
<div id="Histograms" class="section level3">
<h3>2.4.3.1 直方图</h3>
<ul>
<li><code>hist()</code> 函数</li>
</ul>
<pre class="r"><code>args(hist.default)</code></pre>
<pre><code>## function (x, breaks = &quot;Sturges&quot;, freq = NULL, probability = !freq, 
##     include.lowest = TRUE, right = TRUE, density = NULL, angle = 45, 
##     col = NULL, border = NULL, main = paste(&quot;Histogram of&quot;, xname), 
##     xlim = range(breaks), ylim = NULL, xlab = xname, ylab, axes = TRUE, 
##     plot = TRUE, labels = FALSE, nclass = NULL, warn.unused = TRUE, 
##     ...) 
## NULL</code></pre>
<ul>
<li>图 2.8</li>
</ul>
<pre class="r"><code>opar &lt;- par(no.readonly = TRUE) # 读入当下参数
par(mfrow = c(1, 2))            # 一行两列
bin &lt;- seq(20, 70, 10)          # 范围20-70，宽度为10的分块
hist(
  BABERUTH $ hr [7: 21],
  breaks = bin,
  xlab = &quot;Home Runs&quot;,
  col = &quot;pink&quot;,
  main = &quot;Bins of form (]&quot;
  )
hist(
  BABERUTH $ hr [7 : 21],
  breaks = bin,
  right = FALSE,
  xlab = &quot;Home Runs&quot;,
  col = &quot;pink&quot;,
  main = &quot;Bins of form [)&quot;
  )</code></pre>
<p><img src="/r_prob_stat/prob_stat_ch-02_files/figure-html/Figure_02_08-1.png" width="672" /></p>
<pre class="r"><code>par(opar) # 重设为原始参数</code></pre>
<ul>
<li><p><code>breaks = &quot;Sturges&quot;</code></br> <span class="math display">\[
h_{\text{Sturges}} = \frac{R}{1+\log^n_2}
\]</span> 此处的 <code>R</code> 为样本数据的全距。</p></li>
<li><p><code>breaks = &quot;FD&quot;</code> 或 <code>&quot;Freedman-Diaconis&quot;</code> </br> <span class="math display">\[
h_{\text{FD}} = \frac{2\times IQR}{n^{1/3}}
\]</span> 其中 IQR 为样本数据的四分位距。</p></li>
<li><p><code>breaks = &quot;Scott&quot;</code> </br> <span class="math display">\[
h_{\text{Scott}} = \frac{2 \cdot 3 ^{1/3} \cdot \pi ^{1/6} \cdot \hat{\sigma}}{n^{1/3}}
\]</span> 其中 <span class="math inline">\(\hat{\sigma}\)</span> 为样本标准差。当然 R 实际使用的是简化版的公式：</p></li>
</ul>
<p><span class="math display">\[
h_{\text{ScottR}} = \frac{3.5 \cdot \hat{\sigma}}{n^{1/3}}
\]</span></p>
<ul>
<li>R 并不直接使用上述公式计算出来的区间，而是用 <code>pretty(h)</code> 函数对区间进行了进一步优化。</li>
</ul>
</div>
</div>
</div>
